# Excel 导入模板使用说明

## 概述

本项目支持通过 Excel 文件批量导入资源数据，提高资源录入效率。

## 模板文件

### 文件位置
模板文件位于：`docs/Excel导入模板.xlsx`

### 文件结构

导入模板包含以下工作表：
1. **资源列表** - 主要的资源数据
2. **分类列表** - 分类数据
3. **用户列表** - 用户数据（可选）

## 资源列表模板

### 必填字段

| 字段名 | 字段类型 | 长度限制 | 说明 |
|--------|----------|----------|------|
| 标题 | 文本 | 200字符 | 资源标题 |
| 描述 | 文本 | 2000字符 | 资源详细描述 |
| 内容 | 文本 | 5000字符 | 资源内容或链接 |
| 分类名称 | 文本 | 50字符 | 一级或二级分类名称 |
| 上传者用户名 | 文本 | 50字符 | 已存在的用户 |

### 可选字段

| 字段名 | 字段类型 | 默认值 | 说明 |
|--------|----------|--------|------|
| 积分价格 | 数字 | 0 | 0表示免费，大于0表示积分下载 |
| 来源 | 文本 | "" | 资源来源（原创、转载、翻译等） |
| 标签 | 文本 | "" | 多个标签用英文逗号分隔 |
| 状态 | 文本 | "pending" | pending（待审核）、approved（已通过）、rejected（已拒绝） |
| 导入方式 | 文本 | "" | auto（自动）、manual（手动） |
| 下载次数 | 数字 | 0 | 初始下载次数 |

### 示例数据

```
标题,描述,内容,分类名称,上传者用户名,积分价格,来源,标签,状态,导入方式
示例资源1,这是第一个示例资源,https://example.com/resource1,软件/系统工具,admin,0,原创,系统,approved,manual
示例资源2,这是第二个示例资源,https://example.com/resource2,软件/办公软件,user1,10,转载,办公,approved,auto
```

## 分类列表模板

### 必填字段

| 字段名 | 字段类型 | 长度限制 | 说明 |
|--------|----------|----------|------|
| 分类名称 | 文本 | 50字符 | 分类名称 |
| 父分类名称 | 文本 | 50字符 | 顶级分类留空 |

### 示例数据

```
分类名称,父分类名称
软件,
办公软件,软件
系统工具,软件
游戏,
动作游戏,游戏
策略游戏,游戏
```

## 用户列表模板（可选）

### 必填字段

| 字段名 | 字段类型 | 长度限制 | 说明 |
|--------|----------|----------|------|
| 用户名 | 文本 | 50字符 | 用户名（唯一） |
| 邮箱 | 文本 | 100字符 | 邮箱地址（唯一） |
| 密码 | 文本 | 100字符 | 初始密码（建议导入后修改） |
| 角色 | 文本 | 20字符 | user、admin |
| 状态 | 文本 | 20字符 | active、banned |

### 示例数据

```
用户名,邮箱,密码,角色,状态
user1,user1@example.com,password123,user,active
user2,user2@example.com,password456,user,active
admin,admin@example.com,admin123,admin,active
```

## 导入流程

### 步骤1：准备数据

1. 打开 Excel 模板文件
2. 填写相应工作表的数据
3. 确保数据格式正确
4. 保存文件为 `.xlsx` 格式

### 步骤2：上传文件

1. 登录管理员后台
2. 进入**资源管理** > **批量导入**
3. 选择准备好的 Excel 文件
4. 点击**上传**

### 步骤3：验证数据

系统会进行数据验证：
- 检查必填字段
- 验证数据格式
- 检查分类是否存在
- 检查用户是否存在
- 检查重复数据

### 步骤4：确认导入

1. 查看验证结果
2. 修正错误数据（如果需要）
3. 确认导入
4. 等待导入完成

### 步骤5：查看结果

- 查看成功导入的记录数
- 查看失败的记录及原因
- 下载错误报告（如果有）

## 数据验证规则

### 标题验证
- 不能为空
- 长度不超过200字符
- 不能重复（同一分类下）

### 描述验证
- 长度不超过2000字符
- 建议填写完整

### 分类验证
- 必须存在于数据库中
- 可以是顶级或子级分类

### 上传者验证
- 必须存在于数据库中
- 必须有上传权限

### 积分价格验证
- 必须为数字
- 不能为负数
- 最多两位小数

### 状态验证
- 只能是：pending、approved、rejected

## 错误处理

### 常见错误及解决方法

#### 错误1：分类不存在
```
错误：分类"工具软件"不存在
解决：在模板中先导入该分类，或修改为现有分类
```

#### 错误2：用户不存在
```
错误：用户"user123"不存在
解决：先导入用户列表，或修改为现有用户
```

#### 错误3：标题重复
```
错误：资源标题"软件A"在分类"软件"下已存在
解决：修改标题或分类
```

#### 错误4：数据格式错误
```
错误：积分价格"abc"不是数字
解决：修改为数字格式
```

#### 错误5：必填字段为空
```
错误：标题不能为空
解决：补充标题数据
```

## 导入建议

### 1. 数据准备
- 事先整理好数据
- 检查分类层级是否正确
- 确保用户存在
- 检查重复数据

### 2. 分批导入
- 建议每次导入不超过1000条记录
- 大文件可分批处理
- 避免系统压力过大

### 3. 验证测试
- 先用少量数据测试
- 验证导入结果
- 检查数据完整性

### 4. 备份数据
- 导入前备份数据库
- 保存 Excel 原始文件
- 记录导入日志

## 注意事项

1. **编码格式**: Excel 文件必须使用 UTF-8 编码
2. **文件大小**: 建议单个文件不超过10MB
3. **并发限制**: 同一时间只能有一个导入任务
4. **权限要求**: 只有管理员可以执行批量导入
5. **数据清理**: 导入前会检查数据完整性，错误数据不会导入

## 示例文件

以下是标准的 Excel 导入模板示例：

### 资源列表
```
标题,描述,内容,分类名称,上传者用户名,积分价格,来源,标签,状态,导入方式
示例软件A,系统优化工具,https://example.com/software-a,软件/系统工具,admin,0,原创,系统,approved,manual
办公软件包,Office办公软件,https://example.com/office,软件/办公软件,admin,10,转载,办公,approved,auto
```

### 分类列表
```
分类名称,父分类名称
软件,
办公软件,软件
系统工具,软件
游戏,
动作游戏,游戏
策略游戏,游戏
```

## 技术支持

如在导入过程中遇到问题：
1. 查看错误日志
2. 检查数据格式
3. 联系技术支持：admin@example.com

---

**作者**: Felix Wang  
**邮箱**: felixwang.biz@gmail.com  
**更新时间**: 2025-11-04
