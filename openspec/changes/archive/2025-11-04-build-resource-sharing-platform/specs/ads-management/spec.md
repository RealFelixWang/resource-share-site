## ADDED Requirements

### Requirement: 广告管理
系统 SHALL允许管理员创建、编辑、删除广告，并管理广告位。

#### Scenario: 创建广告
- **WHEN** 管理员访问广告管理页面
- **AND** 点击"新建广告"按钮
- **AND** 输入广告信息：标题、图片链接、跳转链接、广告位、显示顺序
- **AND** 点击保存
- **THEN** 创建新广告
- **AND** 广告状态为"已创建"（需要审核或直接发布）

#### Scenario: 编辑广告
- **WHEN** 管理员点击广告的"编辑"按钮
- **AND** 修改广告信息
- **AND** 保存变更
- **THEN** 更新广告信息
- **AND** 如果广告正在显示，更新立即生效

#### Scenario: 删除广告
- **WHEN** 管理员点击广告的"删除"按钮
- **AND** 确认删除操作
- **THEN** 从数据库中删除广告
- **AND** 如果广告正在显示，立即从页面移除

#### Scenario: 广告列表展示
- **WHEN** 管理员访问广告管理页面
- **THEN** 分页显示所有广告
- **AND** 每条显示：标题、广告位、状态（显示/隐藏）、点击次数、创建时间
- **AND** 支持按广告位、状态筛选

### Requirement: 广告位管理
系统 SHALL支持多个广告位，不同页面可以显示不同广告。

#### Scenario: 预定义广告位
- **WHEN** 系统初始化
- **THEN** 创建预定义广告位：首页顶部、首页侧边栏、列表页顶部、详情页顶部、底部横幅
- **AND** 每个广告位有唯一标识符和描述

#### Scenario: 管理员查看广告位
- **WHEN** 管理员访问广告位管理页面
- **THEN** 显示所有广告位列表
- **AND** 每个广告位显示：标识符、描述、当前广告数量、最大广告数
- **AND** 可以查看每个广告位的广告列表

#### Scenario: 配置广告位属性
- **WHEN** 管理员编辑广告位
- **AND** 可以修改：描述、最大广告数、轮播间隔（如果支持）
- **AND** 保存配置
- **THEN** 广告位属性更新

#### Scenario: 广告位禁用/启用
- **WHEN** 管理员将广告位设为禁用
- **AND** 该广告位的所有广告不再显示
- **THEN** 页面加载时不获取该广告位广告
- **AND** 管理员可以随时重新启用

### Requirement: 广告展示
系统 SHALL在前端页面展示活跃的广告。

#### Scenario: 首页广告展示
- **WHEN** 用户访问首页
- **AND** 首页配置了广告位
- **AND** 有活跃的广告
- **THEN** 在对应位置显示广告
- **AND** 广告显示图片、标题
- **AND** 点击广告跳转到指定链接

#### Scenario: 广告轮播
- **WHEN** 广告位配置了多个广告
- **AND** 启用了轮播功能
- **AND** 用户停留在页面
- **THEN** 广告按设定间隔自动切换
- **AND** 显示轮播指示器
- **AND** 用户可以手动切换

#### Scenario: 响应式广告
- **WHEN** 广告在不同设备上显示
- **AND** 移动端适配广告尺寸
- **THEN** 广告图片自动缩放
- **AND** 保持广告比例不变形
- **AND** 点击区域正确响应

#### Scenario: 广告点击统计
- **WHEN** 用户点击广告
- **THEN** 记录点击事件
- **AND** 广告点击次数加1
- **AND** 记录点击时间、用户IP、用户ID（如果已登录）
- **AND** 跳转到广告链接

### Requirement: 广告状态管理
系统 SHALL支持广告的多种状态，管理员可以控制其显示。

#### Scenario: 广告审核
- **WHEN** 管理员创建新广告
- **AND** 系统配置了广告审核流程
- **THEN** 广告初始状态为"待审核"
- **AND** 需要管理员审核通过后才可显示
- **AND** 管理员可以批准或拒绝

#### Scenario: 广告启用/禁用
- **WHEN** 管理员将广告状态设为"隐藏"
- **THEN** 广告不再在任何页面显示
- **AND** 可以随时改回"显示"状态
- **AND** 状态变更立即生效

#### Scenario: 广告有效期
- **WHEN** 管理员设置广告的开始和结束时间
- **AND** 当前时间不在有效期内
- **THEN** 广告不显示
- **AND** 自动在有效期内显示
- **AND** 过期后自动停止显示

#### Scenario: 广告优先级
- **WHEN** 广告位有多个广告
- **AND** 按优先级排序显示
- **THEN** 高优先级广告优先展示
- **AND** 轮播时也按优先级排序

### Requirement: 广告统计
系统 SHALL统计广告的展示和点击数据。

#### Scenario: 展示次数统计
- **WHEN** 广告在页面加载时被渲染
- **THEN** 记录展示事件
- **AND** 广告展示次数加1
- **AND** 记录展示时间、页面位置、用户IP

#### Scenario: 点击率统计
- **WHEN** 计算广告点击率
- **AND** 点击率 = 点击次数 / 展示次数 * 100%
- **THEN** 在广告列表中显示点击率
- **AND** 可以导出统计数据

#### Scenario: 按时间统计
- **WHEN** 管理员查看广告统计
- **AND** 选择时间范围
- **THEN** 显示该时间段的展示次数、点击次数、点击率
- **AND** 支持按日、按月统计

#### Scenario: 广告效果报表
- **WHEN** 管理员访问广告报表页面
- **THEN** 显示所有广告的效果对比
- **AND** 包括：展示量、点击量、点击率、排名
- **AND** 支持导出Excel报表

### Requirement: 广告内容管理
系统 SHALL要求管理员审核广告内容，防止不当内容。

#### Scenario: 图片链接验证
- **WHEN** 管理员添加广告
- **AND** 输入图片链接
- **THEN** 系统验证图片链接可访问
- **AND** 如果链接无效，提示错误
- **AND** 建议上传有效图片

#### Scenario: 跳转链接验证
- **WHEN** 管理员设置广告跳转链接
- **AND** 系统验证链接格式
- **THEN** 如果不是有效URL，提示错误
- **AND** 可以选择在新窗口打开

#### Scenario: 广告内容审核
- **WHEN** 管理员提交新广告或编辑广告
- **AND** 系统配置了内容审核
- **THEN** 广告状态设为"待审核"
- **AND** 管理员审核通过后才可显示
- **AND** 审核记录写入日志

#### Scenario: 广告屏蔽
- **WHEN** 系统检测到违规广告内容
- **OR** 管理员手动标记广告违规
- **THEN** 自动暂停广告显示
- **AND** 通知管理员处理

### Requirement: 广告模板和样式
系统 SHALL支持自定义广告的展示样式。

#### Scenario: 广告样式配置
- **WHEN** 管理员在广告位设置中
- **AND** 可以配置：圆角、阴影、边框样式
- **AND** 保存配置
- **THEN** 该广告位所有广告使用统一样式

#### Scenario: 自适应图片尺寸
- **WHEN** 上传的广告图片尺寸不一致
- **AND** 系统自动裁剪或缩放
- **THEN** 所有广告图片显示尺寸统一
- **AND** 保持图片比例

#### Scenario: 广告加载优化
- **WHEN** 页面加载时
- **AND** 使用懒加载策略
- **THEN** 广告图片仅在可视区域时加载
- **AND** 提升页面加载速度