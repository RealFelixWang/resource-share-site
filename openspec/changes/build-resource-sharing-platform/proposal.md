## 变更动机
需要构建一个完整的资源分享平台，为用户提供软件、电子资料、电影等资源的分享服务。平台需要支持分类浏览、积分获取、广告管理等核心功能，满足用户资源共享和获取的需求。

## 变更内容
### 核心功能
- **用户认证系统**: 用户注册、登录、会话管理，支持管理员角色
- **邀请系统**: 用户通过邀请链接邀请新用户注册，获得积分奖励
- **资源管理系统**: 资源上传、编辑、删除、浏览，管理员可设置积分价格
- **资源导入系统**: 爬虫抓取、Excel模板导入、批量导入功能
- **权限控制系统**: 用户上传权限管理，默认普通用户无上传权限，需管理员开启
- **评论系统**: 用户可对资源发表评论，支持审核和批量管理
- **分类系统**: 多级分类管理，支持软件、电子资料、电影等分类
- **积分系统**: 用户积分余额、消费记录、邀请奖励机制、免费资源默认
- **统计系统**: Dashboard展示每日/每月/季度访问数据和评论统计
- **账户管理**: 管理员可禁止/解禁用户账户
- **IP管理**: 管理员可禁止/解禁特定IP地址
- **广告管理**: 广告位管理、展示统计、广告轮播
- **管理员后台**: 用户管理、资源审核、评论审核、积分管理、权限管理、统计报表

### 技术特性
- 单体架构，使用 Go 1.25.3 开发
- 响应式设计，支持桌面和移动设备
- 使用 GORM 支持 SQLite/MySQL 9 双数据库
- Redis 可选，支持禁用
- 所有代码使用中文注释
- 完整的单元测试和集成测试

### 界面设计
- 美观大气的现代化 UI 设计
- Bootstrap 或 Tailwind CSS 响应式布局
- 移动端友好的导航和交互
- 清晰的信息架构和视觉层次

## 影响范围
### 受影响的规格
- user-auth: 用户认证和授权、邀请链接
- resource-management: 资源管理和浏览、导入方式、积分价格设置
- category-system: 分类系统
- points-system: 积分系统、邀请奖励机制
- admin-panel: 管理员后台、权限管理、评论审核、积分价格管理、Dashboard、账户管理、IP管理
- ads-management: 广告管理
- import-system: 资源导入系统（新增）
- permission-system: 权限控制系统（新增）
- comment-system: 评论系统（新增）
- invitation-system: 邀请系统（新增）
- statistics-system: 统计系统（新增）
- account-management: 账户管理系统（新增）
- ip-management: IP管理系统（新增）

### 受影响的代码模块
- 主程序入口: `cmd/server/`
- 配置管理: `internal/config/`
- 处理器层: `internal/handler/`
- 服务层: `internal/service/`
- 仓储层: `internal/repository/`
- 数据模型: `internal/model/`
- 中间件: `internal/middleware/`
- 前端模板: `web/templates/`
- 静态资源: `web/static/`

### 数据库变更
- 用户表 (users) - 增加上传权限字段、邀请码、邀请关系、账户状态
- 分类表 (categories)
- 资源表 (resources) - 增加导入方式、来源字段、积分价格
- 积分记录表 (points) - 增加邀请奖励记录
- 广告表 (ads)
- 会话表 (sessions)
- 管理日志表 (admin_logs)
- 导入任务表 (import_tasks) - 记录爬虫和导入任务
- 权限配置表 (permissions) - 存储系统权限配置
- 评论表 (comments) - 存储用户评论和审核状态
- 邀请表 (invitations) - 记录邀请关系和积分奖励
- 积分规则表 (points_rules) - 存储积分奖励规则配置
- 访问记录表 (visit_logs) - 记录用户访问行为
- IP黑名单表 (ip_blacklist) - 存储被禁止的IP地址

### 破坏性变更
此变更创建一个全新的系统，无破坏性变更

## 验收标准
- [ ] 用户可以成功注册和登录
- [ ] 用户可以上传和管理资源
- [ ] 分类系统正常显示和过滤
- [ ] 积分系统正确扣费和余额显示
- [ ] 管理员可以后台管理所有数据
- [ ] 广告位正常展示
- [ ] 响应式设计在移动端正常工作
- [ ] 所有单元测试通过，覆盖率 > 80%
- [ ] 集成测试覆盖核心业务流程
- [ ] 网站可正常启动和运行

## 时间估算
预计开发周期: 5-6 周
- 架构设计和数据库设计: 2 天
- 用户认证系统: 3-4 天（含邀请链接）
- 资源管理系统: 5-6 天（含导入功能、积分价格设置）
- 权限控制系统: 2 天
- 评论系统: 3 天（含审核和批量管理）
- 邀请系统: 2-3 天（含邀请奖励机制）
- 爬虫抓取系统: 3 天
- Excel 导入系统: 2 天
- 分类和搜索: 2 天
- 积分系统: 4 天（含邀请奖励、价格管理）
- 统计系统: 3-4 天（含Dashboard、访问记录）
- 账户管理系统: 2-3 天（含账户禁止/解禁）
- IP管理系统: 2-3 天（含IP黑名单）
- 广告管理: 2 天
- 管理员后台: 5-6 天（含权限管理、评论审核、积分价格管理、Dashboard、管理功能）
- 前端模板和样式: 3-4 天
- 测试和优化: 3-4 天